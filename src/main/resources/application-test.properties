# ============================================================================
# TEST ENVIRONMENT CONFIGURATION
# ============================================================================
# This profile is for AUTOMATED TESTING (JUnit, Integration Tests)
#
# To activate: mvn test
#           or set SPRING_PROFILES_ACTIVE=test in test classes
# ============================================================================

# Server Configuration (Random port for parallel test execution)
server.port=0

# Database Configuration (In-memory H2 for fast tests)
spring.datasource.url=jdbc:h2:mem:testdb;MODE=PostgreSQL;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
spring.datasource.username=sa
spring.datasource.password=
spring.datasource.driver-class-name=org.h2.Driver

# JPA Configuration (Create-drop for clean test state)
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.H2Dialect

# Flyway (disabled in tests - using Hibernate DDL)
spring.flyway.enabled=false

# Logging (Minimal for clean test output)
logging.level.root=WARN
logging.level.org.example=INFO
logging.level.org.springframework=WARN
logging.level.org.hibernate.SQL=WARN

# JWT Configuration (Test keys)
jwt.secret=TestSecretKey_OnlyForAutomatedTesting_AtLeast256BitsLongForHS256Algorithm
jwt.expiration=3600000
jwt.refresh-expiration=7200000

# Admin User (Test default)
app.admin.username=testadmin
app.admin.password=testpassword123
app.admin.email=testadmin@test.local

# Email Configuration (Disabled in tests)
spring.mail.host=localhost
spring.mail.port=3025
app.mail.enabled=false

# Redis (Use embedded or mock in tests)
spring.cache.type=simple
spring.data.redis.host=localhost
spring.data.redis.port=6380

# Actuator (Limited exposure in tests)
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=always

# Swagger UI (Disabled in tests)
springdoc.swagger-ui.enabled=false

# Security (Relaxed for testing)
app.security.account-lock.max-failed-attempts=3
app.security.account-lock.lockout-duration-minutes=5

# Rate Limiting (Disabled in tests)
app.rate-limit.enabled=false

# Feature Flags (Selective enablement for tests)
app.features.mfa-enabled=false
app.features.audit-logging-enabled=true
app.features.threat-intelligence-enabled=false
app.features.email-notifications-enabled=false

# Banner (Disabled in tests)
spring.main.banner-mode=off

# Test-specific optimizations
spring.jpa.properties.hibernate.jdbc.batch_size=10
spring.datasource.hikari.maximum-pool-size=2
spring.datasource.hikari.minimum-idle=1

# H2 Console (for debugging tests)
spring.h2.console.enabled=false
